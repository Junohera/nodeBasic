

<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>09_npm</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/default.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <div class="login">
        <h1>Sign up</h1>
        <form action="login" method="POST">
            <input id="userid" type="text" name="userid" placeholder="UserId" required="required" autocomplete="off" />
            <input type="password" name="pwd" placeholder="Password" required="required" autocomplete="off" />
            <input type="password" name="pwd2" placeholder="Password Check" required="required" autocomplete="off" />
            <input type="text" name="name" placeholder="Username" required="required" autocomplete="off" />
            <input type="text" name="phone" placeholder="Phone : 010XXXXXXXX" autocomplete="off" />
            <input type="text" name="email" placeholder="Email" autocomplete="off" />
            <button id="login" class="btn btn-primary btn-block btn-large">post</button>
        </form>
    </div>

    <script>
        document.getElementsByTagName('form')[0].addEventListener('submit', async e => {
            e.preventDefault();
            
            const userid = e.target.userid.value;
            const pwd = e.target.pwd.value;
            const pwd2 = e.target.pwd2.value;
            const name = e.target.name.value;
            const phone = e.target.phone.value;
            const email = e.target.email.value;

            if (pwd !== pwd2) {
                return alert('비밀번호가 다릅니다');
            }

            const member = {
                userid,
                pwd,
                name,
                phone,
                email,
            };
            
            try {
                const res = await axios.post('/signup', member);
                if (res.status === 201) {
                    location.href = '/';
                }
            } catch (e) {
                console.error(e);
            }
        })
    </script>
</body>
</html>
